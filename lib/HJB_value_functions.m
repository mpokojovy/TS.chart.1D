%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                          HAMILTON-JACOBI-BELLMAN VALUE FUNCTIONS                                 %
%                                                                                                  %
% PURPOSE: Loads-up the HJB value functions H_1(t, x; R) and H_2(t, x; R) (Matlab names:           %
% value_func1 and value_func2) to asymptotically estimate the average mean and the average mean    %
% squared exit times past a given time period t for a Markovian diffusion approximating the        %
% TS signal process started at x in [-R, R] from the set [-R, R]                                   %
%                                                                                                  %
% REMARK:  The exponent parameter alpha needs to be defined. Admissible values are                 %
% 3/4, 2/3, 5/8, 3/5 and 1                                                                         %
%                                                                                                  %
% Copyright: Michael Pokojovy and J. Marcus Jobe (2020)                                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

if (abs(alpha - 1) < 1E-4)
    value_func1 = @(t, x, R) ...
        R^2 - x.^2;
    value_func2 = @(t, x, R) ...
        (1/3)*x.^4 + (-2*R^2 - 2*t)*x.^2 + 5*R^4*(1/3) + 2*t*R^2;
elseif (abs(alpha - 3/4) < 1E-4)
    value_func1 = @(t, x, R) ...
        (1/12)*x.^4+(-(1/2)*R^2-sqrt(t))*x.^2+(5/12)*R^4+sqrt(t)*R^2;
    value_func2 = @(t, x, R) ...
        (1/1680)*x.^8+(-(1/60)*R^2-(1/30)*sqrt(t))*x.^6+((5/24)*R^4+(1/2)*sqrt(t)*R^2+(1/2)*t)*x.^4+ ...
        (-(61/60)*R^6-(5/2)*sqrt(t)*R^4-3*t*R^2-2*t^(3/2))*x.^2+(277/336)*R^8+(61/30)*sqrt(t)*R^6+(5/2)*t*R^4+2*t^(3/2)*R^2;
elseif (abs(alpha - 2/3) < 1E-4)
    value_func1 = @(t, x, R) ...
        -(1/405)*x.^6+((1/27)*R^2+(1/9)*t^(1/3))*x.^4+(-(5/27)*R^4-(2/3)*t^(1/3)*R^2-t^(2/3))*x.^2+(61/405)*R^6+(5/9)*t^(1/3)*R^4+t^(2/3)*R^2;
    value_func2 = @(t, x, R) ...
        (1/7577955)*x.^12+(-(2/229635)*R^2-(2/76545)*t^(1/3))*x.^10+((5/15309)*R^4+(2/1701)*t^(1/3)*R^2+(1/567)*t^(2/3))*x.^8+ ...
        (-(244/32805)*R^6-(20/729)*t^(1/3)*R^4-(4/81)*t^(2/3)*R^2-(4/81)*t)*x.^6+((1385/15309)*R^8+(244/729)*t^(1/3)*R^6+(50/81)*t^(2/3)*R^4+(20/27)*t*R^2+(5/9)*t^(4/3))*x.^4 ...
        +(-(101042/229635)*R^10-(2770/1701)*t^(1/3)*R^8-(244/81)*t^(2/3)*R^6-(100/27)*t*R^4-(10/3)*t^(4/3)*R^2-2*t^(5/3))*x.^2+ ...
        (540553/1515591)*R^12+(101042/76545)*t^(1/3)*R^10+(1385/567)*t^(2/3)*R^8+(244/81)*t*R^6+(25/9)*t^(4/3)*R^4+2*t^(5/3)*R^2;   
elseif (abs(alpha - 5/8) < 1E-4)
    value_func1 = @(t, x, R) ...
        (1/26880)*x.^8+(-(1/960)*R^2-(1/240)*t^(1/4))*x.^6+((5/384)*R^4+(1/16)*t^(1/4)*R^2+(1/8)*sqrt(t))*x.^4+ ...
        (-(61/960)*R^6-(5/16)*t^(1/4)*R^4-(3/4)*sqrt(t)*R^2-t^(3/4))*x.^2+(277/5376)*R^8+(61/240)*t^(1/4)*R^6+(5/8)*sqrt(t)*R^4+t^(3/4)*R^2;
    value_func2 = @(t, x, R) ...
        (1/132843110400)*x.^16+(-(1/1107025920)*R^2-(1/276756480)*t^(1/4))*x.^14+((1/14598144)*R^4+(1/3041280)*t^(1/4)*R^2+(1/1520640)*sqrt(t))*x.^12+...
        (-(61/16588800)*R^6-(1/55296)*t^(1/4)*R^4-(1/23040)*sqrt(t)*R^2-(1/17280)*t^(3/4))*x.^10+...
        ((277/2064384)*R^8+(61/92160)*t^(1/4)*R^6+(5/3072)*sqrt(t)*R^4+(1/384)*t^(3/4)*R^2+(1/384)*t)*x.^8+...
        (-(50521/16588800)*R^10-(277/18432)*t^(1/4)*R^8-(427/11520)*sqrt(t)*R^6-(35/576)*t^(3/4)*R^4-(7/96)*t*R^2-(7/120)*t^(5/4))*x.^6+...
        ((540553/14598144)*R^12+(50521/276480)*t^(1/4)*R^10+(1385/3072)*sqrt(t)*R^8+(427/576)*t^(3/4)*R^6+(175/192)*t*R^4+(7/8)*t^(5/4)*R^2+(7/12)*t^(3/2))*x.^4+...
        (-(199360981/1107025920)*R^14-(540553/608256)*t^(1/4)*R^12-(50521/23040)*sqrt(t)*R^10-(1385/384)*t^(3/4)*R^8-(427/96)*t*R^6-(35/8)*t^(5/4)*R^4-(7/2)*t^(3/2)*R^2-2*t^(7/4))*x.^2+...
        (3878302429/26568622080)*R^16+(199360981/276756480)*t^(1/4)*R^14+(540553/304128)*sqrt(t)*R^12+(50521/17280)*t^(3/4)*R^10+(1385/384)*t*R^8+(427/120)*t^(5/4)*R^6+(35/12)*t^(3/2)*R^4+2*t^(7/4)*R^2;
elseif (abs(alpha - 3/5) < 1E-4)
    value_func1 = @(t, x, R) ...
        -(1/2953125)*x.^10+((1/65625)*R^2+(1/13125)*t^(1/5))*x.^8+(-(2/5625)*R^4-(4/1875)*t^(1/5)*R^2-(2/375)*t^(2/5))*x.^6+((122/28125)*R^6+(2/75)*t^(1/5)*R^4+(2/25)*t^(2/5)*R^2+(2/15)*t^(3/5))*x.^4+...
        (-(277/13125)*R^8-(244/1875)*t^(1/5)*R^6-(2/5)*t^(2/5)*R^4-(4/5)*t^(3/5)*R^2-t^(4/5))*x.^2+(50521/2953125)*R^10+(277/2625)*t^(1/5)*R^8+(122/375)*t^(2/5)*R^6+(2/3)*t^(3/5)*R^4+t^(4/5)*R^2;
    value_func2 = @(t, x, R) ...
        (1/6393838623046875)*x.^20+(-(2/67303564453125)*R^2-(2/13460712890625)*t^(1/5))*x.^18+((1/263935546875)*R^4+(2/87978515625)*t^(1/5)*R^2+(1/17595703125)*t^(2/5))*x.^16+...
        (-(488/1319677734375)*R^6-(8/3519140625)*t^(1/5)*R^4-(8/1173046875)*t^(2/5)*R^2-(8/703828125)*t^(3/5))*x.^14+...
        ((554/20302734375)*R^8+(488/2900390625)*t^(1/5)*R^6+(4/7734375)*t^(2/5)*R^4+(8/7734375)*t^(3/5)*R^2+(2/1546875)*t^(4/5))*x.^12+...
        (-(202084/138427734375)*R^10-(1108/123046875)*t^(1/5)*R^8-(488/17578125)*t^(2/5)*R^6-(8/140625)*t^(3/5)*R^4-(4/46875)*t^(4/5)*R^2-(4/46875)*t)*x.^10+...
        ((1081106/20302734375)*R^12+(202084/615234375)*t^(1/5)*R^10+(554/546875)*t^(2/5)*R^8+(488/234375)*t^(3/5)*R^6+(2/625)*t^(4/5)*R^4+(12/3125)*t*R^2+(2/625)*t^(6/5))*x.^8+...
        (-(1594887848/1319677734375)*R^14-(4324424/580078125)*t^(1/5)*R^12-(404168/17578125)*t^(2/5)*R^10-(2216/46875)*t^(3/5)*R^8-(3416/46875)*t^(4/5)*R^6-(56/625)*t*R^4-(56/625)*t^(6/5)*R^2-(8/125)*t^(7/5))*x.^6+...
        ((3878302429/263935546875)*R^16+(1594887848/17595703125)*t^(1/5)*R^14+(2162212/7734375)*t^(2/5)*R^12+(404168/703125)*t^(3/5)*R^10+(554/625)*t^(4/5)*R^8+(3416/3125)*t*R^6+(28/25)*t^(6/5)*R^4+(24/25)*t^(7/5)*R^2+(3/5)*t^(8/5))*x.^4+...
        (-(4809759350882/67303564453125)*R^18-(7756604858/17595703125)*t^(1/5)*R^16-(1594887848/1173046875)*t^(2/5)*R^14-(4324424/1546875)*t^(3/5)*R^12-(202084/46875)*t^(4/5)*R^10-(3324/625)*t*R^8-(3416/625)*t^(6/5)*R^6-(24/5)*t^(7/5)*R^4-(18/5)*t^(8/5)*R^2-2*t^(9/5))*x.^2+...
        (14814847529501/255753544921875)*R^20+(4809759350882/13460712890625)*t^(1/5)*R^18+(3878302429/3519140625)*t^(2/5)*R^16+(1594887848/703828125)*t^(3/5)*R^14+(1081106/309375)*t^(4/5)*R^12+(202084/46875)*t*R^10+(554/125)*t^(6/5)*R^8+(488/125)*t^(7/5)*R^6+3*t^(8/5)*R^4+2*t^(9/5)*R^2;
else
    ERROR_MSG = 'HJB functions are not defined for this choice of alpha. Please choose alpha from the set 3/4, 2/3, 5/8, 3/5 and 1.';
    
    error(ERROR_MSG);
end